shortname: auth_service
name: auth-service
summary: "This service contains two sub-services for the management, authentication 
          and authorization of users of the GHGA data portal. The `auth_adapter` 
          subpackage contains the authentication service used by the API gateway 
          via the ExtAuth protocol. The `user_management` subpackage contains the 
          user data management service. The setting `run_auth_adapter` can be used to 
          determine which of the two services will be started."
version: 0.0.0-58-fc1e78f-main
api:
  rest:
    produces:
      - path: /users
        method: POST
        authentication: true
      - path: /users/{id}
        method: DELETE
        authentication: true
      - path: /users/{id}
        method: GET
        authentication: true
      - path: /users/{id}
        method: PATCH
        authentication: true
      - path: /users/{id}
        method: PUT
        authentication: true
      - path: /users/{user_id}/claims
        method: GET
        authentication: true
      - path: /users/{user_id}/claims
        method: POST
        authentication: true
      - path: /users/{user_id}/claims/{claim_id}
        method: DELETE
        authentication: true
      - path: /users/{user_id}/claims/{claim_id}
        method: PATCH
        authentication: true
storage:
  mongodb:
    - db_name: auth_service
      mode: read-write
extra_config:
    - name: run_auth_adapter
      description: Boolean for whether running Auth Adapter
    - name: api_ext_path
      description: External API path for the user management as seen by the auth adapter
    - name: auth_key
      description: Internal public key for user management (key pair for auth adapter)
    - name: auth_algs
      description: Allowed algorithms for signing internal tokens
    - name: auth_check_claims
      description: Internal claims that shall be verified
    - name: auth_map_claims
      description: Mapping of claims to the internal auth context
    - name: auth_ext_keys
      description: External public key set for auth adapter (not used for user management)
    - name: auth_ext_algs
      description: Allowed algorithms for signing external tokens
    - name: basic_auth_user
      description: User(s) and password(s) for basic authentication
    - name: basic_auth_pwd
      description: Password(s) for basic authentication if not specified above
    - name: basic_auth_realm
      description: Realm for basic authentication
    - name: oidc_authority_url
      description: URL for external token content for validation in auth adapter
    - name: oidc_userinfo_endpoint
      description: Endpoint for external token content for validation in auth adapter
    - name: oidc_client_id
      description: Client ID for external token content for validation in auth adapter
    - name: organization_url
      description: The URL used as source for internal claims
    - name: users_collection
      description: Database collection for Users
    - name: claims_collection
      description: Database collection for claims
    - name: db_url
      description: Database connection string for MongoDB